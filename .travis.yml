language: java
dist: trusty
jdk: openjdk11

sudo: false
install: true

if: tag is blank

notifications:
  email: false

services:
  - redis-server

addons:
  sonarcloud:
    organization: "bbortt-github"
    token:
      secure: "EuAgnZ70us8S6SwDGl76jH98xzOu+5jaNvs4Qm8Gizv1dKDu9wThPJ1wdq8EAD43A1AGsQOWaSEdKwmCJJKFZeBE4CohlI/RrUtVuUnj2rG4sJj+a+0z3BdMDju/9Z1fqaOl8JkS+E8qu5jQ16EFLFTwKgiH9kyyC4v0Qoiczxai+OagOimVPL/yQc253NUDU6B3W1/f/LCAQunhzri3lVFOKK3uPtI8r8QiOyRzqAtPw2hC9pflCi5LuaTMBtIxBzDMgLO5atFbdbOXE2iynl2MJVACHGJ/qfchZQCNT9rUZ/7rg0n1OjkMdp1iSrlk3yq5l7lPcWljmewH4xZGK15OQIPU0YBmo1vfH3cis6klBYMERQTc4LWG1DwLE6ti8AIry+M5+qojFGtcP1K9eai+5vSU4MBjDQrZxRy3KI4Ed54zMSbp/wcQuvwn+qeI6wXuwljzB6bF8Xg0zG81yXrLAI/gW9gciu8397hejhgFztocDeNP6ibDSgKbYThTmZygBFebR8kfjSISmNK3wWj0j2HDBdPZPgHJmm7qM2YBwL13+e5HsW6QCAAYwN8DpWl22xBcsv9Q/p3vjjzXemmFJ6X06a7XBktvKNM9fAMez7/kZC4r5hze1wBrt6s5WkV114kJgpBuARitg6eSSx/ZUCbrV9c9L1pZhszSmAQ="

script:
  - ./gradlew dependencyUpdates
  - ./gradlew -Pversion=$TRAVIS_BUILD_NUMBER --no-daemon -i build sonarqube

after_success:
  - bash <(curl -s https://codecov.io/bash)

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
    - $HOME/.sonar/cache
